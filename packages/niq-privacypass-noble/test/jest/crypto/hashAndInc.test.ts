import { hexToBytes } from '@noble/hashes/utils'

import { hashAndInc } from '../../../src/crypto/hashAndInc'

const TEST_CASES = [
  {
    method: 'increment',
    data: '57e24e50869714fe9f3d3fc4c924c39f4aefd4ab4abade08b494cbcff81a1d99',
    P: '0459b2beec2fb77cae415cf7d7b3d554980b40b40c7bb2d445dafc6d9512d15128c358fe11d752af966cd4b2fb31dda1a9383980a7f57c85da06c37dcaf3522a62'
  },
  {
    method: 'increment',
    data: '423be39e567223c80c0e56bc61dd47041191daaa6a4de6642e384081b378ceea',
    P: '04fbaeb37f6e17ca4f7a7f4a9d478657aab8d3b2e2f25567364a1690561ea94dbf622492c00a7eb4c7579ff5d50b812dcc2ba6dbdad136a66d58a85185d44769c2'
  },
  {
    method: 'increment',
    data: 'f982778ccea0cb7782f20be92e87adcdaf874cb9d93877efe0026028b3a0cca8',
    P: '04e5c335a85f1a8707d692581462dbe5b2379b1ae9c9374d141cb6facec4c40dcb8d0f26bd0361e4ecc54cf016e92a7b293347fd145b5405c23ce09a54cf43a628'
  },
  {
    method: 'increment',
    data: '5d182b0703b9a129c450f9a5fe804679c1ce33fe46244ecfe994c223a50ba1a1',
    P: '045b60267c3333e8a8c98f9f916435f458e5ff6e6067bd7cf6b18f689d8ee70d609989c49c7070ab73b74ca82961da76cc2a06d0fbe322ec34ba117a82365ead20'
  },
  {
    method: 'increment',
    data: 'dd8dd984bb6da66563d3d8d34e3e42845ef419a25fe93f37f2baa1bb3be0b9fe',
    P: '04e14bc8f5b12d6db2af84b760859de87cb3dca78a15b9f10832cde19ca95db5b03cb1037aa66856b546079eae8894e2d2ac8f151e982caa6f8a9d718297463a5e'
  },
  {
    method: 'increment',
    data: '3e5c913efcc3ac095dd57c3e182074ba506226026b205743143872485ddfb344',
    P: '04155846fe6c4804a883b7c55409f44b49dce34896c4101d66a2e1637f39ca1b5ff77296f09ed250a6c4a3280fe9bb7b3384136e7e0f73bdb7d2b5ea4c5754174a'
  },
  {
    method: 'increment',
    data: '7c4db78b0487410aed97260a15991350bc31687e0383870e8a2fea00f0cfbc81',
    P: '04dc18ed007b2417bf3b6d6352b7593cc7cadd7686742edaa4875fdf5eb9c7acfd555da2b4b027b6a84c87335805f5c31e3698497844b5eafa7d7117706273c266'
  },
  {
    method: 'increment',
    data: 'f3067caeefb7bff62b0062c9093d499e136f398e4405011f5caa6264f556037c',
    P: '044cafb2bee6d4feb42036ab74376aa031b09e57b5de49dc1e050973f75f8b7d393f1913e83636f13d0b968db2a9d1195c767b2da73b9687b300f8c8f9f059cc06'
  },
  {
    method: 'increment',
    data: '4e609e375ba13e1cc8a5d3cc8d9b26fe982add079a197aa06e6c8034a10a3bb0',
    P: '04e444f8d6740f4b96e67c443fcac21705e283c53df4ad90f43fd671ec77c97fe8283739c46655d6577bcfd82cbb8a63f6996128267f35ed59d877ded23fbd2178'
  },
  {
    method: 'increment',
    data: '39a54f7b03b421ba3c64b91b7b378758e0489b91f03f345e2d859aa855228a53',
    P: '04683d5ce640df10ff32b71feca19092283894a5ac4336b9026e37ecff0bc6b4cfe1d46f7297665f44ce32161840dbc0631586a5b1085d2d4398d02e14f47f8374'
  },
  {
    method: 'increment',
    data: 'fad04ecef6c3d9150592e1cbe0e357dabc09dd54499042455ce53ca5ff7bfa9a',
    P: '04d605693b94b63033fd4d6cfb478b1e614f777ce7cb01650920a62be2b71ddc815ca90df5d0eba27e4929f56ef4d7d764e5175d9d4fe2e4855e63624df6264f74'
  },
  {
    method: 'increment',
    data: 'f7381f559cf6b03343ccfbe9e5e9ec1179e153af1c0ebc7265e98a35beec33d1',
    P: '046dc406a40b06c3e787197189f509147151d198ffde244eb018747a7737e2273b40a42e9564cb49094488e75b6e50a16d1d09fcc85704c930a6857a35b7a79f56'
  },
  {
    method: 'increment',
    data: 'a663d85a66b343834c2911d62cfeb2c71ec78a4c2e034805be248f058546d74b',
    P: '046767106ca3f0b82b9e996fcedb12176c2b807b2a0a028bb28f0cc94667d51d31806cdaba0479e3a2ee74b62e56b2b6c5ba87ef114873afcee5f8a8b807133156'
  },
  {
    method: 'increment',
    data: '4956f20dbaab788c7a2d6598f5072d73dfbccf87757971d09bee183dcd729b46',
    P: '042ef19931d39046d9a521e0ecfb683ccc13abfda3da5c72fc53be5543daf888aaac5d1bbc3e2abb6a96f1711a7295bbcdc402a894e4af08ac2c9ddfca4339318c'
  },
  {
    method: 'increment',
    data: '69a8b292d5b2c8b389ce1809db7c958bad94c77b2916cf395867ec640ed5bd34',
    P: '04e5573c576ac5767add137c2c4ce5cf2163942fdaa7c1d5ac3b97223dd085770a5b9bc74573d2dd14d5cbd3803d0577167c9ccdf1087c583a8c7436e7473330ac'
  },
  {
    method: 'increment',
    data: '4d9eb9c1aefdf5ed06e3ec6681a99929d83aa0df29de45fdbfa940044a10d5a5',
    P: '0437c23302f5d2c7abfb2ac91e0391c92a680d707c1d8ccebdad3ffbab207244e79878e82d3d2ac9ec46cca84298d1f118db6651ac55df181705168bc2ac24ba5e'
  },
  {
    method: 'increment',
    data: '3568514932b005600ff19a3fd130758d7b6ab32a024668b9967a8cec8a88a70c',
    P: '0432ee9b88eb0b3fd34a1965700d783052bbfb623901682293b262e3eb950b90476a7b45cb15627f517497d7502340b4b4a143cc36b34b87b4ac12deab24db5370'
  },
  {
    method: 'increment',
    data: '39fc8f255d07069b6cfc1f49813bae06c01d37826e885155208bc9a8f3bad3ef',
    P: '049a7ccb5bb488206a7f1cc4ee1f96782693d91be177871866c0810c81110010601ec0d275ed4898f5f201d8c206a10cba1892e0230e96f7cbe18251eab0027a50'
  },
  {
    method: 'increment',
    data: 'd02a4e52c7152964e5bfae96ff69aae84fb57b64809403fe05d6dc7f20bc26e4',
    P: '04d9d3beaef7629fd14a389583810f287a789d69813864d8e12787f64cb7877cd09da40d60da8b47f281b9dd861e9f074dde3a4eca800cf4c13a94d92d8ca447b4'
  },
  {
    method: 'increment',
    data: '4d29409ef316ba9604ad413b22326dfc843426c9cc134a3c77921c4a9049f798',
    P: '04a23167681ce0fe4d1e34607c5af21b25c25ee1156b54adf65dec790fb2d75d78afbfed438918af5e38b23647c411392816cffee62c9dc8cc0fbd08de6b185eb6'
  },
  {
    method: 'increment',
    data: '1a6e733be9a804ca498c40ca9f8c8af307122fdf02dbf281e05b3bb208cba8da',
    P: '04cf8fc36ce855bfe13da40e1039df05d3c7c6638499129722edad79496d6fceb6d74b963617b0d148ab3bc47fb232d825d0830f1032b391543fcc97554141561c'
  },
  {
    method: 'increment',
    data: '2a403ef5b1bc1bc6853010b5c968fad3ae8ca2b0b7f930c5a82a9512e2b9c4e6',
    P: '04c5b91a3e02d2117f1e3e94efa8aa9f9dc5f0f9165d50fd6cc0f1c29d5ee1f2705f5cdf4e9b6ec23d895aa170a9b2d2c372a7bed408623f4bf19e407edeea4c00'
  },
  {
    method: 'increment',
    data: '5ad7e51ac1f3121d644e859bc908004e8980f8d42c452594024306b8f838cee1',
    P: '046bea59a72c405173e3bfa6f3975bb4b1bc6a446155e3d9251b0eab5c55805925a1a03812be9b3562812c6b0525271dde91eb413030fb4c139cf20d605dca472a'
  },
  {
    method: 'increment',
    data: '44297f3a4a33733e5a09f059817ccd389a8bc784ff7ef83730a5b87da6cfa51f',
    P: '04d5034a98b38bca9be2ac0ae8656b8a2d140f4fd575041f37a886faefa73d88e0b3e7420457f0efe948cf44cd703b0b893a46950a2eaa0e6fd366c441053047ac'
  },
  {
    method: 'increment',
    data: '34aa1a9dbffed5d7c96342e68f8051d7e214c8d668281afec02d42bcc5ab40b8',
    P: '04d5dfe75676641a8a741e127a000d0c1aeec2dc38284c32cd3894705f0487d0237cf0cb4815427e4ffc26da35961a1f51f1779776b792535c87dbfea649992e68'
  },
  {
    method: 'increment',
    data: '23bdb8d2e2ba77471aba54ffde49b5d4a91a358947fe3864ac524c7927b75288',
    P: '0452d62c17c9db74098a63718e041e5d2f3b99816e8c3ce2161292e7601784e6128e5c85f2dd57a39002025109bc0626acf98e90dee1d92743a7d0903d0fd3a6a4'
  },
  {
    method: 'increment',
    data: '2df5921fb95bbfca866ceb9889ad613687255d38e671c7427fb90a388be83757',
    P: '046ba14bc5bd45e18b34f06aaf11ae8bdd6a0d89c6aa37de3c63c45801d73140bd9c785a0f816db688d9f2e3eaa0b27f7915acabf6247b7a13e8e34573cde9887c'
  },
  {
    method: 'increment',
    data: 'ae8af1b0b30064a1888d87077352343905c34d38c3033f37521cece8f1d6a783',
    P: '04c011c619781637935963ce25b51188b32be1ced6cc48cf3b2b599b20b774bd02e59625707875fb2c4fe0a6ac3472f3ea1066693201753f4fe5c2ce262ee088cc'
  },
  {
    method: 'increment',
    data: 'd296a75afad792851b62c8a15fe37001b53265233748004eebb66ac472fc916d',
    P: '046721d118d1470b61ebcbb69ff20ad2564c09aa6cffe02531fd1682f281e12f76c5f1afadac6b58a5e5a11b734a4a08c91174070f594f1a760d5a0e114285fed4'
  },
  {
    method: 'increment',
    data: '1c875c1425697e793433dde62aa6567fc265060b2cd29679cef686f2cfef74ac',
    P: '042871d89105c82b2c40a5d104006338966d1a3d8bc6429e73b74f7951abac76b8d7e64625100340b89c3e54587dae6f7608fe602aba8cbeefa0228a6e10b53c2c'
  }
]
describe('hashAndInc', () => {
  const cases = TEST_CASES.map(c => [c.data, c.P])
  it.each(cases)('should create for data %s the point %s', (data, point) => {
    const hashed = hashAndInc(hexToBytes(data))
    expect(hashed.toHex(false)).toBe(point)
  })
})
